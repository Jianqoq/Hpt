# Matmul Benchmark

::: chartjs Matmul f32 Performance (M = N = K)
```json
{
  "type": "line",
  "data": {
    "labels": [64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 896, 960, 1024, 1088, 1152, 1216, 1280, 1344, 1408, 1472, 1536, 1600, 1664, 1728, 1792, 1856, 1920, 1984, 2048, 2112, 2176, 2240, 2304, 2368, 2432, 2496, 2560, 2624, 2688, 2752, 2816, 2880, 2944, 3008, 3072, 3136, 3200, 3264, 3328, 3392, 3456, 3520, 3584, 3648, 3712, 3776, 3840, 3904, 3968, 4032, 4096, 4160, 4224, 4288, 4352, 4416, 4480, 4544, 4608, 4672, 4736, 4800, 4864, 4928, 4992, 5056, 5120],
    "datasets": [
      {
        "label": "Hpt(faer-gemm)",
        "data": [109.01046258254462, 141.44295075687063, 202.87419207686062, 288.0919217245592, 346.993171484019, 394.9180694544829, 464.3924131062779, 550.1657329567887, 506.0350519010833, 573.1686163026682, 626.1361478746818, 647.2475914028324, 668.9760529655205, 671.498489788445, 677.3978676203661, 669.9406527266975, 665.6851606299348, 666.4936059788569, 678.7648542195485, 684.3691541229308, 680.3479368990405, 683.0635246713998, 673.993411186458, 674.2507103905853, 668.3166637138742, 666.1467526037414, 669.9318560062217, 665.4447931812235, 670.4264078747034, 669.7767922732487, 673.7887016875015, 664.2146653044796, 638.5207582427936, 652.1348885942981, 657.7508249147671, 656.8019428812275, 653.5011743985076, 659.4600630256335, 661.122652041117, 659.2562741109308, 663.7608903198862, 664.1527732976928, 658.618538038762, 663.7252127495012, 644.4870861936852, 659.9716915306667, 672.7261143859141, 674.7398295732379, 671.0244188091782, 664.0006315868313, 674.2985490177902, 678.1884738178472, 681.4996325227445, 684.5479737313433, 687.198655480231, 679.6754040777639, 685.05033574518, 683.4847232988088, 677.6447146129641, 682.4116179572161, 689.2754968317405, 683.9217868856049, 686.369850973822, 688.917060010025, 678.043757946786, 673.5062683109918, 682.1822701449275, 679.1057648444902, 679.9578625819186, 677.8393667546173, 666.9573213719566, 678.5348385020804, 674.0150194844679, 682.9125056637736, 681.8249075215783, 675.3223271361503, 682.8952168445078, 688.0584042477876, 690.2388016875835, 666.7547342275211],
        "backgroundColor": "rgba(255, 206, 86)",
        "borderColor": "rgb(255, 206, 86)",
        "borderWidth": 3,
        "pointRadius": 0
      },
      {
        "label": "Hpt",
        "data": [58.82442700128803, 141.47381827834727, 180.84143955947368, 273.73268716478293, 325.39410640252225, 380.65632389643787, 438.1154651283244, 526.9823930443115, 617.3605578746237, 629.6386700425104, 664.0163523942367, 671.719449246938, 678.7435934134606, 704.5144397406939, 709.9009028453527, 702.0171553312083, 701.8353669321244, 704.0635962526735, 690.5212894429211, 679.0609920593863, 688.8405340711486, 683.3737820198386, 678.7746067698248, 681.219001089079, 676.1394329456282, 683.5968759643916, 684.7396908518974, 685.7588050116708, 684.3755023219707, 675.1144305233083, 689.972412454375, 682.115809710711, 667.3334936087979, 667.6383900352195, 667.3624676743394, 675.6020414195586, 671.3297849138019, 652.7173956146567, 673.73353314143, 664.7348111283427, 673.9869435228469, 679.1121201017614, 681.4963656703821, 680.2415382802715, 685.0525676003168, 671.704521597304, 678.2343737173999, 672.6659591480544, 674.742269639805, 677.6794155319385, 679.5695815575228, 674.2599430449469, 681.8965454897526, 679.1046254159829, 679.3490342679128, 682.8679461825183, 688.2878136699367, 679.9260901030243, 681.5047161518987, 685.0950272232304, 686.8883955440115, 683.3607353787258, 687.2694182752293, 670.2704387807852, 689.4067129518793, 682.6571686956521, 688.2864764033174, 688.3211875407097, 686.3252703407053, 692.5891931446178, 694.6083374717749, 692.5834274429304, 696.336445530898, 689.1147600129743, 693.3667711598746, 699.5436142492401, 688.1965885681426, 697.3147953363228, 696.0000840926224, 696.5113025428127],
        "backgroundColor": "rgb(67, 241, 32)",
        "borderColor": "rgb(67, 241, 32)",
        "borderWidth": 3,
        "pointRadius": 0
      },
      {
        "label": "Hpt(new)",
        "data": [146.52897527983117, 121.47635495401668, 225.9015659362624, 311.4936463689373, 429.94276898599543, 551.766266614202, 605.4286000355385, 620.9979947236485, 653.3411735332432, 654.6098743623448, 664.0919863661869, 665.55038816, 677.7916727486013, 676.2867081927948, 680.1029095966232, 675.045889796126, 676.8930007050014, 668.1595487884991, 675.6331589907151, 660.0928087117375, 674.6696738560544, 680.3145915481886, 684.2907933985603, 678.4859537302694, 682.2531797360115, 685.0753228903134, 680.6631610951284, 686.7153068874587, 688.2665362872726, 685.3301452977219, 688.3401518224495, 678.268634651854, 667.5177209464754, 659.6172926697952, 670.127103726215, 668.3145625103189, 678.2773401544279, 678.9653336439301, 681.3630200768326, 679.1323898340205, 690.5129548044608, 691.2923772632694, 691.3310034945724, 690.2081471173819, 678.0573391798648, 698.5727024428064, 691.4141838836694, 687.6896128306179, 691.4011174750374, 683.2952391389302, 700.0737596059843, 686.6133281895784, 689.3237378124618, 689.5029423799973, 688.1021509153799, 693.8459789600604, 696.1840409776247, 684.5519535463875, 696.2673466020045, 696.4711439114391, 701.4642766165634, 696.5022879821627, 690.1639459647276, 696.7754295158428, 701.157009982956, 694.1317193092333, 701.6081501401558, 703.447511909537, 701.7043250845386, 709.8116597592264, 704.2538651454306, 699.7655906454496, 710.7752043770693, 707.0019318202995, 715.1115421920465, 701.0351784587267, 698.6420709398716, 697.5102858873001, 707.8160767579409, 698.8686696172871],
        "backgroundColor": "rgb(0, 225, 255)",
        "borderColor": "rgb(0, 225, 255)",
        "borderWidth": 3,
        "pointRadius": 0
      },{
        "label": "Hpt(new3)",
        "data": [21.78435529214474, 31.895345829917353, 80.43054545454545, 172.82216182629375, 226.60689098499032, 358.6424335551079, 427.31282921870786, 473.3648265111644, 560.0353646128775, 562.2828162406223, 666.1502514742818, 707.3545064378753, 729.7339521304691, 668.2184100977533, 734.0691083133265, 742.914421117938, 718.5068173067575, 639.1592260557846, 733.2807628976624, 752.7068244242811, 707.045908101173, 621.3155973879011, 770.6054773591201, 757.4750433323312, 702.0568069659578, 715.4991663830672, 728.662241484786, 776.3182543668919, 729.4867173325601, 659.0318545582808, 712.3403236044932, 731.2064304638818, 751.4155321829285, 746.0197459322785, 702.008150568673, 781.2804593501371, 771.6492545908072, 758.9913991981421, 749.8727009163803, 765.7196562284225, 748.5077208185024, 776.4253152491027, 748.8827772671019, 753.2512096282313, 721.3200565116043, 802.0638983685826, 730.4298879378323, 751.0123980477267, 743.9943037098783, 733.0222828692922, 779.5423629193774, 747.697477183889, 768.9402385172045, 772.7940618029847, 780.2183899821109, 760.9368711404959, 778.8326276583201, 727.7321336512276, 771.514772983723, 779.7535552164277, 793.8853537558372, 773.9393649055436, 751.0549500773417, 804.4422210828212, 772.8534192163177, 750.0905839661608, 776.9718243114067, 787.8275957753883, 797.376512, 772.8009626128063, 770.3138028243021, 725.178608204558, 739.7785451432717, 781.512159323156, 790.5075053609721, 796.0907958768591, 779.657242684039, 794.894309827476, 725.4965793769296, 766.0829223744292],
        "backgroundColor": "rgb(255, 0, 0)",
        "borderColor": "rgb(255, 0, 0)",
        "borderWidth": 3,
        "pointRadius": 0
      },{
        "label": "Hpt(new4)",
        "data": [113.9897769941058, 38.595185539761566, 106.07854837647268, 185.5274936439654, 286.5661533784819, 403.11440421024287, 480.2258886423428, 516.1352902634304, 568.4214668593955, 617.9579119894642, 674.124347442177, 703.6125298171619, 731.9307459219491, 682.3195966902824, 716.3477602900288, 673.5793279662145, 594.9922242619809, 616.3858970087216, 684.490039662011, 728.3419961372193, 774.9366766971117, 721.5210623426342, 697.8743847744074, 787.3921553581955, 755.6833429535981, 758.8404919290068, 707.7509746423552, 734.1004832956792, 724.1216609377843, 798.1411411397968, 723.5978779149009, 700.9838169386718, 705.6566433422882, 736.0871208834441, 684.8697408734931, 724.0652487716817, 705.4926772755592, 742.7051221047984, 731.8150750229614, 745.0090149770472, 709.0784423868647, 754.6032897407263, 712.8573675155179, 775.7484936768175, 797.6436009888783, 764.2804394172931, 743.7278697611058, 750.3812740259342, 726.4915009241844, 745.9382113578557, 726.7321974410117, 755.6603885574947, 760.2062600655611, 755.7601047950811, 767.1804397537378, 752.8484170727719, 760.7297016443125, 755.129529430238, 753.5181606158153, 799.7613559322034, 763.1685412390588, 744.2079241453245, 766.6470265263157, 806.0935687507331, 771.6108896034298, 734.9132269527059, 740.1381447735272, 748.3110504584657, 792.4238628571429, 774.131657339647, 760.6341401216052, 789.070352516129, 778.7588579457808, 786.1390583237743, 773.1003145753233, 808.6783172452565, 759.8564238222222, 791.3547041221375, 780.9499432990937, 821.4059241126071],
        "backgroundColor": "rgb(187, 255, 0)",
        "borderColor": "rgb(187, 255, 0)",
        "borderWidth": 3,
        "pointRadius": 0
      },{
        "label": "Hpt(dyn)",
        "data": [92.46734556382914, 37.22378276447227, 98.45113659101216, 192.89504170581543, 277.2676880420355, 365.16708509390605, 467.3103965130788, 518.1295246140975, 549.2313295295273, 597.7990980312964, 665.7716545127709, 696.3084685243047, 736.475215095465, 699.6691293002309, 697.8795138709328, 688.1694002106331, 752.9584761453802, 703.7398296321567, 664.0264675257338, 717.3731848526359, 744.5596123317025, 678.4126430320939, 698.0160623291205, 772.2828266695681, 757.0255869565822, 669.3579612171809, 719.3089166218149, 776.6244005967355, 743.0106825250964, 698.684726314648, 764.6667808869236, 752.5028976367469, 696.4872851735349, 735.8822918333998, 703.1488852521597, 732.0006728383349, 670.5812701062885, 760.1112779597102, 693.4780696080824, 682.2347612061303, 674.7715235314882, 691.9640938425536, 685.9823857732559, 691.4849739051231, 689.3400831641642, 705.3693277500887, 695.4293650230694, 775.2958191250793, 740.8146425563617, 720.9165975892672, 735.7180052438097, 735.5478291607375, 734.8679104128024, 722.2789644094488, 748.5275972754155, 764.0942855435685, 751.8931408351032, 759.9916809509658, 777.269575225632, 791.0096018442139, 765.2952702765274, 811.9071505133203, 777.7908130287748, 775.8337763025685, 798.3509398392015, 799.2083926193002, 788.2350999450136, 777.424779136996, 781.9901320862656, 766.7055382647624, 799.1841668143101, 787.4826858108652, 804.2466281388013, 802.9254743461829, 798.2100324792494, 813.9694043784261, 817.4684887431695, 785.6075749163246, 798.068636097561, 800.3442337507455],
        "backgroundColor": "rgb(255, 166, 0)",
        "borderColor": "rgb(255, 166, 0)",
        "borderWidth": 3,
        "pointRadius": 0
      },
      {
        "label": "Candle(mkl)",
        "data": [16.385940709852825, 80.02149014627953, 157.61139469586286, 263.51423283665173, 348.77660761423573, 500.4378502767966, 535.2046774714664, 411.2365061886212, 430.02532744478583, 484.008440089194, 508.32698708277195, 547.2449906983359, 573.7719783914262, 578.8183362367064, 607.0293901283156, 594.2188153749438, 607.7882595262228, 601.4183113552058, 602.8718428327701, 612.2362187919643, 618.197524108963, 612.2139246806335, 614.1590437589356, 611.7122423540835, 612.6019735416774, 626.8352960884683, 625.4279214545454, 617.565228835597, 632.660355460819, 627.4916057529172, 633.0719644722453, 625.9344785707942, 632.2321065826571, 624.4183218159229, 628.8132296394965, 637.8944462006051, 645.517559486366, 643.8015279177939, 620.4416068481133, 636.3301391663841, 637.5401906406657, 636.8320912412443, 653.3365053254084, 648.602993632838, 663.6238207801739, 654.3883978414755, 657.384607889124, 619.6039891410603, 655.1772383152194, 661.1645092114913, 675.7791399726171, 660.9601354411524, 657.208177719416, 626.3769774810319, 634.2347261423711, 618.63400723446, 664.2722981650107, 652.1828514886835, 653.7810877474195, 634.6102998038666, 633.1652808087257, 628.37571266784, 630.4238592738639, 620.3518549853305, 636.1059951402696, 634.1215938073202, 628.1076747420833, 633.3189566500191, 649.4469328506788, 646.6407191657677, 648.9657353207679, 644.9882907844429, 658.7756618087853, 644.5815549514563, 649.5859030837005, 634.5460410476977, 666.1697008182576, 649.6133654725849, 645.4292914656678, 606.4967374604608],
        "backgroundColor": "rgb(234, 32, 241)",
        "borderColor": "rgb(234, 32, 241)",
        "borderWidth": 3,
        "pointRadius": 0
      }
    ]
  },
  "options": {
    "animation": false,
    "responsive": true,
    "plugins": {
      "legend": {
        "position": "top"
      }
    },
    "scales": {
      "y": {
        "beginAtZero": true,
        "title": {
          "display": true,
          "text": "GFlops"
        }
      },
      "x": {
        "beginAtZero": true,
        "title": {
          "display": true,
          "text": "N"
        }
      }
    }
  }
}
```
:::

::: chartjs Matmul f16 Performance (M = N = K)
```json
{
  "type": "line",
  "data": {
    "labels": [64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 896, 960, 1024, 1088, 1152, 1216, 1280, 1344, 1408, 1472, 1536, 1600, 1664, 1728, 1792, 1856, 1920, 1984, 2048, 2112, 2176, 2240, 2304, 2368, 2432, 2496, 2560, 2624, 2688, 2752, 2816, 2880, 2944, 3008, 3072, 3136, 3200, 3264, 3328, 3392, 3456, 3520, 3584, 3648, 3712, 3776, 3840, 3904, 3968, 4032, 4096, 4160, 4224, 4288, 4352, 4416, 4480, 4544, 4608, 4672, 4736, 4800, 4864, 4928, 4992, 5056, 5120],
    "datasets": [
      {
        "label": "Hpt(faer-gemm)",
        "data": [63.29320527121452, 62.55929203645419, 147.59738599600198, 223.16800442259893, 269.18826937852816, 324.78542508077885, 340.2204012426476, 291.202171777519, 321.2399028377893, 351.89858430570223, 421.6469590988618, 435.71549245713715, 481.255393495723, 466.0971787710845, 502.23229538501903, 528.3429274865817, 485.97260704949224, 504.41577759078916, 521.2462465915315, 566.5244186075206, 586.394219247582, 571.5738417520812, 605.0255364964852, 605.8945076659389, 593.0093073194445, 618.8532670955275, 608.9402820566823, 623.14531064028, 629.0494648172115, 630.2247728123726, 645.7855269506446, 586.2397194553917, 620.0457367165525, 635.9811605946524, 635.485294317822, 645.1484607763826, 650.217979926563, 658.9696267631564, 661.5427139506618, 661.8400696587469, 671.9360751355528, 657.6397536802777, 655.9802949115893, 660.1069318640159, 655.9559730733973, 661.5940079611735, 662.6644716195708, 663.2920077204697, 656.6265050193285, 660.8874220997759, 661.6517021673933, 663.1402138092012, 660.7315850299303, 653.4814166293795, 667.7347486774111, 672.0683314452554, 666.5524090282253, 673.2140852648897, 680.8583316598165, 685.7172752043596, 684.1242571313596, 688.0644849339207, 688.7136408510638, 691.3428243058349, 673.4452385406921, 675.9224342959641, 673.0108055655143, 681.2104314710743, 679.4214066745561, 687.6894225621414, 691.4091465291084, 684.4681616789087, 683.7309584177003, 687.9989653886009, 687.1202236719479, 679.9109278818315, 677.0997836039604, 683.7095877328936, 681.6836266666668, 679.2395141700405],
        "backgroundColor": "rgba(255, 206, 86)",
        "borderColor": "rgb(255, 206, 86)",
        "borderWidth": 3,
        "pointRadius": 0
      },
      {
        "label": "Hpt(v0.1.2)",
        "data": [4.9035421350453126, 43.888333319556, 114.69073319698671, 185.08899370670218, 250.3994925681181, 295.37473837268294, 337.2260788430873, 283.6936794072938, 324.307871002554, 353.303494958433, 379.4503853032364, 441.4340802467787, 474.0090528486176, 488.61071073182643, 548.6377495136688, 561.4685839659718, 602.9095010870269, 603.6612586829469, 604.952891264712, 616.8617724433902, 620.3957426318851, 614.9163034523474, 625.6323158888171, 625.3107218708157, 624.9346119632809, 624.9581306268855, 638.4686628539214, 632.4321590948729, 626.5941168746538, 629.2061296296704, 639.037148402064, 597.0796771191086, 657.7128546321388, 663.7562841546477, 661.4204959233182, 677.4731786465297, 675.1198536561017, 687.7556886165737, 692.1151647054902, 683.1186251315835, 684.1290631915963, 698.231767567196, 673.3189811589821, 682.5909234436115, 679.0335735230575, 683.4814324420306, 680.3260587697068, 690.4333948024517, 701.7184026201423, 700.1126557175534, 699.7993069721881, 697.5655254793795, 690.5434200380579, 695.8961980976649, 709.1741138211382, 700.0002134591992, 700.8744050986736, 702.5747270329671, 707.2429895041051, 705.1445080946452, 714.9499220666868, 704.7518920699379, 703.4968689884627, 701.3980784485839, 712.4324195942603, 716.2304720741269, 718.7166442297174, 717.8442169214021, 728.7215002834779, 731.0194471544715, 729.7236724402101, 728.6890613442561, 725.4381820949671, 732.72660980169, 728.7775947281714, 726.4831094949494, 724.8781753603877, 734.7959804370938, 722.4550900838457, 732.030149986365],
        "backgroundColor": "rgb(32, 105, 241)",
        "borderColor": "rgb(32, 105, 241)",
        "borderWidth": 3,
        "pointRadius": 0
      },{
        "label": "Hpt(v0.1.3)",
        "data": [12.61442990999592, 57.886921664411304, 131.8317168884913, 196.18234561699413, 254.3876592174226, 298.6421572005272, 341.3074655173824, 319.8417378562101, 389.8732182028379, 442.3664716238406, 479.3831403581477, 513.865029964978, 525.5298986723834, 548.705308229679, 562.6005203318445, 567.6103289975927, 575.3822121433425, 597.6433130930226, 606.6434600175515, 615.223179127741, 608.5377389461598, 615.1132370814163, 605.1050404296766, 604.1366944650204, 612.5543817640903, 611.967927268934, 618.2502814877961, 610.6712399389003, 617.0387858390612, 621.6936491799083, 628.3093722981052, 622.1955351342295, 663.5791131551783, 663.1182703382135, 667.3881997661207, 668.2671391365905, 672.8539781078092, 667.4477379871311, 668.2437967846201, 672.9414137941161, 669.4785611894944, 677.2054520234423, 677.6690278101717, 683.4048236125141, 668.884739043719, 678.0562277847271, 683.2761864803307, 681.8293378340644, 687.9958913672681, 690.5890080921475, 680.5714125200903, 686.3974590689013, 682.6917601598452, 693.55770625297, 690.4623957965822, 694.0203121031653, 693.5319113142856, 683.0283569133534, 687.597350906769, 699.0506666666666, 683.3385847143268, 662.1754661579228, 645.1606374803149, 648.755975794194, 697.0834761558945, 694.7716194883614, 698.964679716312, 707.5232807553648, 707.6143245357437, 715.6020055710305, 713.3565571868465, 702.5289801615507, 707.4469125771765, 710.5487642541807, 713.7270087124879, 711.4369369026274, 702.5382257235103, 695.5602990662566, 699.0114419469983, 703.8160880964867],
        "backgroundColor": "rgb(67, 241, 32)",
        "borderColor": "rgb(67, 241, 32)",
        "borderWidth": 3,
        "pointRadius": 0
      },
      {
        "label": "Candle(mkl)",
        "data": [16.96542636842902, 101.53359322499993, 227.2577838547775, 322.9152032744954, 380.9822337734332, 464.6624117619616, 516.7756341135262, 547.5622287857096, 573.4994617261693, 524.801964804231, 534.2993446529254, 411.64886991308833, 402.9274088604431, 371.46482281239537, 374.6280611735998, 390.0580392618429, 399.1074706634945, 411.53446325447413, 410.7597823639808, 413.5052811720643, 438.8948629232683, 445.37862551689096, 442.2689820880514, 441.95392041330615, 437.17414403071683, 457.4569415716954, 469.68091633743046, 456.54056231853906, 467.9601818595369, 474.44709317800766, 465.15873646937706, 474.3437776468703, 489.99696534230605, 499.0122960306427, 501.3966270082747, 503.1551347130756, 512.0112486430762, 514.5387665007177, 515.1261552021358, 527.219373988636, 523.1166616356468, 544.4418230845794, 543.9082869905253, 547.7165406929817, 542.1380995335961, 545.5477663208782, 548.3910483889875, 555.8538974432596, 550.0769225371604, 565.7784172824684, 569.1270661865793, 582.4526239298801, 588.2021445064055, 583.4380610035336, 591.2454767417813, 597.8789701818182, 600.6462578657593, 589.4259882224143, 578.7570284977156, 613.9669720791542, 611.5283377595067, 616.5926990574883, 601.6367211381367, 576.0224370159262, 606.3701495051589, 608.3983969646821, 626.6101003139281, 608.2011599926212, 623.8077746903296, 628.120097799511, 638.9119590330268, 628.2165246356341, 632.0326770870778, 630.053619549229, 646.3588544710695, 625.7472786514409, 630.5447141833508, 638.6086216016425, 638.2578548938271, 638.3720713436386],
        "backgroundColor": "rgb(234, 32, 241)",
        "borderColor": "rgb(234, 32, 241)",
        "borderWidth": 3,
        "pointRadius": 0
      }
    ]
  },
  "options": {
    "animation": false,
    "responsive": true,
    "plugins": {
      "legend": {
        "position": "top"
      }
    },
    "scales": {
      "y": {
        "beginAtZero": true,
        "title": {
          "display": true,
          "text": "GFlops"
        }
      },
      "x": {
        "beginAtZero": true,
        "title": {
          "display": true,
          "text": "N"
        }
      }
    }
  }
}
```
:::

# Compilation config
```cargo
[profile.release]
opt-level = 3
incremental = true
debug = false
lto = "fat"
codegen-units = 1
```

# Running Threads
`10`

# Device specification
`CPU`: 12th Gen Intel(R) Core(TM) i5-12600K   3.69 GHz

`RAM`: G.SKILL Trident Z Royal Series (Intel XMP) DDR4 64GB

`System`: Windows 11 Pro 23H2