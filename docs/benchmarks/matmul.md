# Matmul Benchmark

::: chartjs Matmul f32 Performance (M = N = K)
```json
{
  "type": "line",
  "data": {
    "labels": [64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 896, 960, 1024, 1088, 1152, 1216, 1280, 1344, 1408, 1472, 1536, 1600, 1664, 1728, 1792, 1856, 1920, 1984, 2048, 2112, 2176, 2240, 2304, 2368, 2432, 2496, 2560, 2624, 2688, 2752, 2816, 2880, 2944, 3008, 3072, 3136, 3200, 3264, 3328, 3392, 3456, 3520, 3584, 3648, 3712, 3776, 3840, 3904, 3968, 4032, 4096, 4160, 4224, 4288, 4352, 4416, 4480, 4544, 4608, 4672, 4736, 4800, 4864, 4928, 4992, 5056, 5120],
    "datasets": [
        {
        "label": "Torch",
        "data": [110.0407388828605, 120.51371785743632, 125.4548408157955, 126.16646547246108, 127.4190834575165, 126.46347907800224, 126.75018633246357, 125.2523618383431, 128.30823963816485, 128.21743749128464, 127.34514297399777, 125.22490530986941, 128.07957606797123, 127.54543699500091, 126.5023387746433, 125.11822104345724, 125.23489308072479, 126.69356043388211, 125.66327985198129, 126.65649945367929, 126.1491378790753, 125.01792522445214, 125.78655827829928, 125.16873302416691, 124.97206482669267, 123.54114520533025, 125.54606809437065, 125.54984041499101, 126.17749416476877, 124.68387551745987, 126.09577885559483, 126.57074546479792, 125.10848509960161, 124.51127221752266, 125.44, 124.83378886450626, 125.62327371807001, 121.36144752583843, 119.80061583975345, 120.91687207207207, 121.70580413607276, 125.95152186770429, 126.93229602923265, 127.71217898770374, 128.05077459126238, 127.48462844866349, 127.00222357442836, 128.30727704359373, 127.57385504033091, 128.50196078431372, 128.74366436134764, 129.44528025285337, 128.82393889420698, 129.09536455355746, 128.69344349365596, 129.66252838755105, 129.3385741094978, 127.51792602343555, 128.264139549732, 129.82484007795483, 129.0429565473867, 128.55196549794238, 128.63962470415072, 128.60386775708807, 128.95888222122704, 128.60981471672355, 128.92358085520402, 129.10402100086145, 129.79150459080634, 129.71996249008149, 129.0389508788337, 130.0867163624277, 129.43894453005012, 129.01025049307748, 129.5974687994375, 129.5596988786309, 129.2063554677463, 129.12030669780475, 128.97636524897715, 129.04309970195175],
        "backgroundColor": "rgb(255, 99, 133)",
        "borderColor": "rgb(255, 99, 132)",
        "borderWidth": 3,
        "pointRadius": 0
      },
      {
        "label": "Hpt(faer-gemm)",
        "data": [105.43602201678408, 109.14381400577425, 198.85461525321637, 269.4987687822056, 341.96261578859594, 389.9035392824013, 444.8405425650656, 507.28211992636534, 533.3252735771624, 575.6296520240757, 600.0860399216673, 633.3225247796258, 643.336510600982, 651.7818860915452, 650.7542362785204, 639.9818082258496, 618.8414190308625, 628.4514624286475, 641.0293480359054, 638.4879781237419, 631.0810649098244, 640.1922130742665, 635.5625592864714, 639.6741472687982, 649.4090518338891, 644.5439553207649, 652.1718437110675, 657.2279024306137, 653.6902287321041, 667.2620203092102, 651.264213005737, 665.9310972979877, 626.5257449661299, 616.2696226329558, 624.0072449932375, 628.3606109714364, 621.6734639105481, 635.4903601693599, 618.6304495670142, 624.6231660320606, 626.7689899508955, 639.090940053345, 635.6619762876238, 642.327519215805, 648.7148705364008, 662.9110350274659, 637.0611598753435, 662.6422619713643, 675.8560543701548, 671.2967594040199, 670.9025578422404, 672.8240380446356, 667.3219541787597, 675.9537579223787, 675.1425386996906, 665.2699523699423, 678.5078098113207, 671.006102040013, 683.2344235532995, 689.0551140857925, 687.086688960739, 679.8286749945592, 681.0215144727273, 689.6083967486201, 693.223842079923, 684.206549468906, 692.2143623529412, 689.9055217242101, 686.1885521593625, 694.9981990338165, 693.32511497506, 698.2674305941124, 695.7426058195464, 703.490332821192, 701.5033301617506, 682.7346457668347, 683.8707814399999, 692.4628972335097, 684.3908690283293, 692.2007632800411],
        "backgroundColor": "rgba(255, 206, 86)",
        "borderColor": "rgb(255, 206, 86)",
        "borderWidth": 3,
        "pointRadius": 0
      },
      {
        "label": "Hpt(builtin gemm)",
        "data": [16.68927287792614, 94.14599787300233, 180.3641997645392, 249.3257909921239, 319.0143888457117, 367.73134924289286, 427.92758972281507, 481.64683661637974, 526.4105320353352, 554.3483602712835, 581.7326333808254, 621.8897488606355, 636.7069391775342, 632.5705981769546, 634.2488781010031, 634.463976938059, 615.6056664936148, 630.0491501155474, 625.3365790769351, 626.5958165146044, 636.3714041355512, 631.1152816327512, 644.6265337641075, 633.228921180768, 636.898223055979, 647.6325422642939, 648.2347643841333, 636.3680190593125, 651.8437275141209, 656.8871546739967, 662.773015002643, 658.9867127501195, 610.8817276712257, 610.3432694594998, 614.2415613810736, 624.879215459257, 640.5232654594336, 612.4052574678686, 612.4129786182593, 619.6496699997559, 620.8114819640099, 628.6668907313366, 652.8846635752775, 648.2606455585565, 657.8092210728204, 663.1123985042402, 647.8334389032794, 660.681085628752, 669.3222711400531, 669.4266535688968, 670.6504967618115, 673.0287928141518, 668.4649549566525, 667.2129765696986, 676.3640423707322, 672.8869286984869, 669.7709881473955, 670.7861000393442, 671.098442829542, 679.9532152506754, 685.1088919286126, 673.5984391590297, 676.4532586996903, 683.4358700745897, 641.9197146678555, 680.8071492682926, 686.9371890394249, 686.4581487237143, 684.9605352634718, 690.9924457252641, 686.7280599011895, 691.4821463745583, 690.4432799458361, 698.6322936928641, 680.3568132882189, 685.3777518999403, 687.2086520356014, 692.0776605730181, 692.6431705037513, 692.2007632800411],
        "backgroundColor": "rgb(32, 105, 241)",
        "borderColor": "rgb(32, 105, 241)",
        "borderWidth": 3,
        "pointRadius": 0
      },
      {
        "label": "Candle(mkl)",
        "data": [17.51345941664782, 92.91671088050256, 183.021500582844, 275.2819606084577, 349.8470993721959, 478.3381305320126, 531.3675508551071, 409.9267229071706, 452.33211742467785, 492.0884067052564, 509.3029562827829, 562.0857873009935, 561.8832858536585, 582.6836556084053, 591.8166486286549, 586.5360419787656, 605.1168197538885, 600.2752483006296, 597.6152222222923, 601.5859329351844, 600.4674652617505, 613.0371276133485, 608.8553812750923, 612.9484593098173, 615.2309610823548, 616.433876299341, 617.121912322724, 617.8235523452589, 617.7873059238489, 617.2576745083223, 615.5112318818109, 599.9047331458969, 617.9066463720959, 609.0547357901988, 616.9124624475018, 616.9377436702106, 622.373546668561, 631.1448793550517, 623.3648662504256, 620.9602153014159, 618.3556093703575, 628.7461844545459, 633.1791176942362, 629.1655517212331, 628.3275752927628, 624.1615495244192, 628.3887230901621, 592.3444387831723, 633.0317796253876, 641.3013420228017, 656.86335849556, 647.9849437606802, 642.5995436925741, 644.6367956521437, 633.9274418604651, 591.351068773282, 629.6658079377431, 621.8533754164133, 633.3985008941175, 619.5087964989059, 611.0573274865211, 612.2122021754042, 622.7868956579573, 610.1618356137625, 620.4808963585434, 618.6361701128668, 617.4096779326546, 614.5495784380242, 629.507772631579, 627.4626099092811, 634.8052854127199, 622.8181012858053, 639.3634636238245, 638.5755350526, 637.7854671280277, 625.2372971692474, 630.8771046494466, 629.5595115789474, 627.413668038835, 596.6558257390532],
        "backgroundColor": "rgb(234, 32, 241)",
        "borderColor": "rgb(234, 32, 241)",
        "borderWidth": 3,
        "pointRadius": 0
      }
    ]
  },
  "options": {
    "animation": false,
    "responsive": true,
    "plugins": {
      "legend": {
        "position": "top"
      }
    },
    "scales": {
      "y": {
        "beginAtZero": true,
        "title": {
          "display": true,
          "text": "GFlops"
        }
      },
      "x": {
        "beginAtZero": true,
        "title": {
          "display": true,
          "text": "N"
        }
      }
    }
  }
}
```
:::

::: chartjs Matmul f16 Performance (M = N = K)
```json
{
  "type": "line",
  "data": {
    "labels": [64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 896, 960, 1024, 1088, 1152, 1216, 1280, 1344, 1408, 1472, 1536, 1600, 1664, 1728, 1792, 1856, 1920, 1984, 2048, 2112, 2176, 2240, 2304, 2368, 2432, 2496, 2560, 2624, 2688, 2752, 2816, 2880, 2944, 3008, 3072, 3136, 3200, 3264, 3328, 3392, 3456, 3520, 3584, 3648, 3712, 3776, 3840, 3904, 3968, 4032, 4096, 4160, 4224, 4288, 4352, 4416, 4480, 4544, 4608, 4672, 4736, 4800, 4864, 4928, 4992, 5056, 5120],
    "datasets": [
      {
        "label": "Hpt(faer-gemm)",
        "data": [63.29320527121452, 62.55929203645419, 147.59738599600198, 223.16800442259893, 269.18826937852816, 324.78542508077885, 340.2204012426476, 291.202171777519, 321.2399028377893, 351.89858430570223, 421.6469590988618, 435.71549245713715, 481.255393495723, 466.0971787710845, 502.23229538501903, 528.3429274865817, 485.97260704949224, 504.41577759078916, 521.2462465915315, 566.5244186075206, 586.394219247582, 571.5738417520812, 605.0255364964852, 605.8945076659389, 593.0093073194445, 618.8532670955275, 608.9402820566823, 623.14531064028, 629.0494648172115, 630.2247728123726, 645.7855269506446, 586.2397194553917, 620.0457367165525, 635.9811605946524, 635.485294317822, 645.1484607763826, 650.217979926563, 658.9696267631564, 661.5427139506618, 661.8400696587469, 671.9360751355528, 657.6397536802777, 655.9802949115893, 660.1069318640159, 655.9559730733973, 661.5940079611735, 662.6644716195708, 663.2920077204697, 656.6265050193285, 660.8874220997759, 661.6517021673933, 663.1402138092012, 660.7315850299303, 653.4814166293795, 667.7347486774111, 672.0683314452554, 666.5524090282253, 673.2140852648897, 680.8583316598165, 685.7172752043596, 684.1242571313596, 688.0644849339207, 688.7136408510638, 691.3428243058349, 673.4452385406921, 675.9224342959641, 673.0108055655143, 681.2104314710743, 679.4214066745561, 687.6894225621414, 691.4091465291084, 684.4681616789087, 683.7309584177003, 687.9989653886009, 687.1202236719479, 679.9109278818315, 677.0997836039604, 683.7095877328936, 681.6836266666668, 679.2395141700405],
        "backgroundColor": "rgba(255, 206, 86)",
        "borderColor": "rgb(255, 206, 86)",
        "borderWidth": 3,
        "pointRadius": 0
      },
      {
        "label": "Hpt(builtin gemm)",
        "data": [4.9035421350453126, 43.888333319556, 114.69073319698671, 185.08899370670218, 250.3994925681181, 295.37473837268294, 337.2260788430873, 283.6936794072938, 324.307871002554, 353.303494958433, 379.4503853032364, 441.4340802467787, 474.0090528486176, 488.61071073182643, 548.6377495136688, 561.4685839659718, 602.9095010870269, 603.6612586829469, 604.952891264712, 616.8617724433902, 620.3957426318851, 614.9163034523474, 625.6323158888171, 625.3107218708157, 624.9346119632809, 624.9581306268855, 638.4686628539214, 632.4321590948729, 626.5941168746538, 629.2061296296704, 639.037148402064, 597.0796771191086, 657.7128546321388, 663.7562841546477, 661.4204959233182, 677.4731786465297, 675.1198536561017, 687.7556886165737, 692.1151647054902, 683.1186251315835, 684.1290631915963, 698.231767567196, 673.3189811589821, 682.5909234436115, 679.0335735230575, 683.4814324420306, 680.3260587697068, 690.4333948024517, 701.7184026201423, 700.1126557175534, 699.7993069721881, 697.5655254793795, 690.5434200380579, 695.8961980976649, 709.1741138211382, 700.0002134591992, 700.8744050986736, 702.5747270329671, 707.2429895041051, 705.1445080946452, 714.9499220666868, 704.7518920699379, 703.4968689884627, 701.3980784485839, 712.4324195942603, 716.2304720741269, 718.7166442297174, 717.8442169214021, 728.7215002834779, 731.0194471544715, 729.7236724402101, 728.6890613442561, 725.4381820949671, 732.72660980169, 728.7775947281714, 726.4831094949494, 724.8781753603877, 734.7959804370938, 722.4550900838457, 732.030149986365],
        "backgroundColor": "rgb(32, 105, 241)",
        "borderColor": "rgb(32, 105, 241)",
        "borderWidth": 3,
        "pointRadius": 0
      },
      {
        "label": "Candle(mkl)",
        "data": [17.111093124596934, 106.12295707872822, 236.5240638137185, 335.8158943137315, 383.4332003560752, 458.5940796255317, 508.3820161953301, 536.6681587696169, 579.246476631315, 595.8860440680716, 526.0119399129744, 424.4186533446965, 392.44812620738804, 405.8116645990241, 405.28131758901543, 392.58366785357515, 424.223602057904, 415.0165104056881, 432.69337876353956, 441.40511354018344, 447.6033999368737, 444.29224603482294, 464.87216682413356, 472.30645976531207, 462.4855195442274, 464.72767443337693, 491.2658730065428, 488.12439144980584, 486.264432199783, 494.93472826113305, 501.7178729553021, 495.87657045186614, 475.4015843635765, 522.9243638937515, 530.990979585234, 537.2709962052943, 546.3040060375142, 550.3720086294171, 551.3972991605525, 551.1757112193471, 562.0460771120199, 567.8651223849579, 566.5863342090599, 574.5085155335274, 574.801919978445, 577.0996403396268, 590.1485149225251, 588.6736246427307, 522.876170474064, 589.1759065205028, 608.9958624168125, 603.2658519148936, 609.6414312264941, 618.2462728461869, 618.7875336812772, 612.7331060733643, 618.6331161771266, 638.5448205742822, 627.3099047596854, 650.6533065211146, 649.5819570305677, 638.9798540731271, 632.8585157422158, 600.4323000087375, 648.1323069997749, 659.3644044094489, 662.6872525488549, 673.6940106906416, 678.4846428678353, 673.6496872073421, 678.5335106418369, 687.2324755891133, 675.5778234382246, 685.1147388326345, 675.7836846929422, 678.1079819917502, 690.7785671111111, 688.4391781294964, 679.8906660494476, 682.5208644800407],
        "backgroundColor": "rgb(234, 32, 241)",
        "borderColor": "rgb(234, 32, 241)",
        "borderWidth": 3,
        "pointRadius": 0
      }
    ]
  },
  "options": {
    "animation": false,
    "responsive": true,
    "plugins": {
      "legend": {
        "position": "top"
      }
    },
    "scales": {
      "y": {
        "beginAtZero": true,
        "title": {
          "display": true,
          "text": "GFlops"
        }
      },
      "x": {
        "beginAtZero": true,
        "title": {
          "display": true,
          "text": "N"
        }
      }
    }
  }
}
```
:::

# Compilation config
```cargo
[profile.release]
opt-level = 3
incremental = true
debug = false
lto = "fat"
codegen-units = 1
```

# Running Threads
`10`

# Device specification
`CPU`: 12th Gen Intel(R) Core(TM) i5-12600K   3.69 GHz

`RAM`: G.SKILL Trident Z Royal Series (Intel XMP) DDR4 64GB

`System`: Windows 11 Pro 23H2